<div class='container'>
  <% @users.each do |u|  %>

    <div>
      <%= link_to u.email , user_path(u) %>
    </div>

    <div>
      <%= form_for @request do |r| %>
      <%= r.hidden_field :invitor_id, value: current_user.id%>
      <%= r.hidden_field :invitee_id, value: u.id %>
      <%= r.hidden_field :accepted, value: false %>

  <% if current_user.followees %>
    <%= r.submit "Request Friend" %>
      <!-- check for followees before running condition-->
      <% elsif current_user.followees %>
        <!-- dont allow user to request themselves or request someone already followed-->
        <% current_user.followees.each do |f| %>
          <% if f.email != u.email && u.email != current_user.email %>
            <% elsif current_user.sent_requests %>
              <% current_user.sent_requests.each do |sent_request| %>
                  <%= r.submit "Request Friend" unless u.id == sent_request.invitee_id %>
              <% end %>
            <% end %>
          <% end %>
        <% end %>
    <% end %>
  </div>

<% end %>
</div>
